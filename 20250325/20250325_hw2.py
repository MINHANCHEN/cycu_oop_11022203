#https://rate.bot.com.tw/xrt/quote/ltm/USD
import matplotlib.pyplot as plt
import pandas as pd
from io import StringIO

# Input data: The provided data for Taiwan Bank USD/TWD rates
data = """
日期,匯率(買入),匯率(賣出)
20250325,32.68,33.35
20250324,32.635,33.305
20250321,32.6,33.27
20250320,32.61,33.28
20250319,32.645,33.315
20250318,32.6,33.27
20250317,32.615,33.285
20250314,32.56,33.23
20250313,32.57,33.24
20250312,32.56,33.23
20250311,32.49,33.16
20250310,32.52,33.19
20250307,32.44,33.11
20250306,32.455,33.125
20250305,32.425,33.095
20250304,32.515,33.185
20250303,32.525,33.195
20250227,32.42,33.09
20250226,32.395,33.065
20250225,32.405,33.075
20250224,32.315,32.985
20250221,32.35,33.02
20250220,32.395,33.065
20250219,32.35,33.02
20250218,32.37,33.04
20250217,32.305,32.975
20250214,32.385,33.055
20250213,32.41,33.08
20250212,32.46,33.13
20250211,32.445,33.115
20250210,32.445,33.115
20250208,32.39,33.06
20250207,32.355,33.025
20250206,32.43,33.1
20250205,32.45,33.12
20250204,32.585,33.255
20250203,32.57,33.24
20250124,32.285,32.955
20250123,32.37,33.04
20250122,32.375,33.045
20250121,32.38,33.05
20250120,32.405,33.075
20250117,32.53,33.2
20250116,32.53,33.2
20250115,32.665,33.335
20250114,32.57,33.24
20250113,32.72,33.39
20250110,32.565,33.235
20250109,32.55,33.22
20250108,32.49,33.16
20250107,32.335,33.005
20250106,32.465,33.135
20250103,32.515,33.185
20250102,32.48,33.15
20241231,32.385,33.055
20241230,32.325,32.995
20241227,32.32,32.99
20241226,32.3,32.97
20241225,32.275,32.945
"""

# Read data into a DataFrame
df = pd.read_csv(StringIO(data), encoding="utf-8")

# Convert date to datetime format
df['日期'] = pd.to_datetime(df['日期'], format='%Y%m%d')

# Plot the buy and sell rates over time
plt.figure(figsize=(10, 6))
plt.plot(df['日期'], df['匯率(買入)'], label='買入匯率', color='blue')
plt.plot(df['日期'], df['匯率(賣出)'], label='賣出匯率', color='red')
plt.title('台灣銀行台幣與美金匯率(近三個月)')
plt.xlabel('日期')
plt.ylabel('匯率 (TWD/USD)')
plt.legend()
plt.xticks(rotation=45)
plt.grid(True)

# Show the plot
plt.tight_layout()
plt.show()
